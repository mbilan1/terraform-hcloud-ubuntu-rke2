# ──────────────────────────────────────────────────────────────────────────────
# bootstrap-token-secret.yaml — K8s Secret holding the OpenBao bootstrap token
#
# DECISION: Store bootstrap token as a K8s Secret rather than in values.yaml.
# Why: The token is sensitive — injecting it via K8s Secret + secretKeyRef
#      keeps it out of Helm values, helmfile diffs, and Git history.
#      The operator creates this Secret from Terraform output before deploy.
#
# USAGE:
#   kubectl create namespace openbao
#   kubectl create secret generic openbao-bootstrap-token \
#     --namespace openbao \
#     --from-literal=token="$(tofu output -raw openbao_bootstrap_token)"
#
# NOTE: This file is a template/documentation reference. The actual Secret
#       should be created via kubectl (above) or via the Helmfile presync hook
#       to avoid committing the token value to Git.
# ──────────────────────────────────────────────────────────────────────────────
apiVersion: v1
kind: Secret
metadata:
  name: openbao-bootstrap-token
  namespace: openbao
  labels:
    app.kubernetes.io/component: bootstrap
    app.kubernetes.io/part-of: openbao
  annotations:
    description: "One-time bootstrap token for OpenBao initial access. REVOKE after configuring permanent auth."
type: Opaque
stringData:
  # SECURITY: Replace with actual token from Terraform output.
  # Run: tofu output -raw openbao_bootstrap_token
  token: "OPENBAO_BOOTSTRAP_TOKEN"
